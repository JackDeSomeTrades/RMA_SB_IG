<?xml version="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro">

  <xacro:macro name="neobotix_pcw" params="name steering_sign wheel_sign">
    <joint
      name="pcw_${name}_virtual"
      type="fixed">
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <parent
        link="pcw_${name}" />
      <child
        link="pcw_${name}_base_link" />
    </joint>

    <link
        name="pcw_${name}_base_link">
        <inertial>
          <origin
            xyz="0.068676 0.000080 0.060449"
            rpy="0 0 0" />
          <mass
            value="5" />
          <inertia
            ixx="0.01386833"
            ixy="0"
            ixz="0"
            iyy="0.02433708"
            iyz="0"
            izz="0.02455208" />
        </inertial>
        <visual>
          <origin
            xyz="0 0 0"
            rpy="0 0 0" />
          <geometry>
            <mesh
              filename="package://neobotix_pcw_description/meshes/pcw_base_link.STL" />
          </geometry>
          <material
            name="">
            <color
              rgba="1 1 1 1" />
          </material>
        </visual>
        <collision>
          <origin
            xyz="0.0525 0 0.064"
            rpy="0 0 0" />
          <geometry>
            <box
              size="0.20500 0.12000 0.12800" />
          </geometry>
        </collision>
      </link>
      <link
        name="pcw_${name}_rotate_link">
        <inertial>
          <origin
            xyz="0 -0.013786 -0.098176"
            rpy="0 0 0" />
          <mass
            value="4" />
          <inertia
            ixx="${10*0.01374714}"
            ixy="0"
            ixz="0"
            iyy="${10*0.01447043}"
            iyz="0"
            izz="${10*0.00734337}" />
        </inertial>
        <visual>
          <origin
            xyz="0 0 0"
            rpy="0 0 0" />
          <geometry>
            <mesh
              filename="package://neobotix_pcw_description/meshes/pcw_rotate_link.STL" />
          </geometry>
          <material
            name="">
            <color
              rgba="1 1 1 1" />
          </material>
        </visual>
        <collision>
          <origin
            xyz="0 -0.013025 -0.107975"
            rpy="0 0 0" />
          <geometry>
            <box
              size="0.11000 0.08400 0.1388" />
          </geometry>
        </collision>
      </link>
      <joint
        name="${name}_caster_rotation_joint"
        type="continuous">
        <origin
          xyz="0.095 0 0"
          rpy="0 0 -3.14159265358979" />
        <parent
          link="pcw_${name}_base_link" />
        <child
          link="pcw_${name}_rotate_link" />
        <axis
          xyz="0 0 ${steering_sign}" />
      </joint>
      <link
        name="pcw_${name}_wheel_link">
        <inertial>
          <origin
            xyz="0 0 0"
            rpy="0 0 0" />
          <mass
            value="2" />
          <inertia
            ixx="${10*0.00418952}"
            ixy="0.0"
            ixz="0.0"
            iyy="${10*0.00807904}"
            iyz="0.0"
            izz="${10*0.00418952}" />
        </inertial>
        <visual>
          <origin
            xyz="0 0 0"
            rpy="0 0 0" />
          <geometry>
            <mesh
              filename="package://neobotix_pcw_description/meshes/pcw_wheel_link.STL" />
          </geometry>
          <material
            name="">
            <color
              rgba="1 1 1 1" />
          </material>
        </visual>
        <collision>
          <origin
            xyz="0 0 0"
            rpy="${pi/2} 0 0" />
          <geometry>
            <cylinder
              radius="0.0898835"
              length="0.03" />
          </geometry>
        </collision>
      </link>
      <joint
        name="${name}_caster_r_wheel_joint"
        type="continuous">
        <origin
          xyz="0 0.044649999999999 -0.12195"
          rpy="-9.63831971360485E-17 -2.77555756156289E-17 -9.28601314642794E-17" />
        <parent
          link="pcw_${name}_rotate_link" />
        <child
          link="pcw_${name}_wheel_link" />
        <axis
          xyz="0 ${wheel_sign} 0" />
        <dynamics
          damping="1.0"
          friction="10.0" />
      </joint>
  </xacro:macro>

</robot>
